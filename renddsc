--// RennD1 - Violence District (ESP ONLY)
--// UI Draggable + Open Close (FIXED)
--// By RennD1

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

-- GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "RennD1UI"
ScreenGui.Parent = game.CoreGui
ScreenGui.ResetOnSpawn = false

-- MAIN UI
local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.new(0, 420, 0, 300)
Main.Position = UDim2.new(0.3, 0, 0.25, 0)
Main.BackgroundColor3 = Color3.fromRGB(25,25,25)
Main.BorderSizePixel = 0
Main.Active = true
Main.Draggable = true
Main.Visible = false
Main.ZIndex = 10
Instance.new("UICorner", Main).CornerRadius = UDim.new(0,12)

-- HEADER
local Header = Instance.new("TextLabel", Main)
Header.Size = UDim2.new(1,0,0,45)
Header.BackgroundColor3 = Color3.fromRGB(35,35,35)
Header.Text = "üî• RennD1 | Violence District"
Header.TextColor3 = Color3.new(1,1,1)
Header.Font = Enum.Font.GothamBold
Header.TextSize = 18
Header.BorderSizePixel = 0
Header.ZIndex = 11

-- CLOSE BUTTON
local Close = Instance.new("TextButton", Header)
Close.Size = UDim2.new(0,40,1,0)
Close.Position = UDim2.new(1,-40,0,0)
Close.Text = "X"
Close.BackgroundTransparency = 1
Close.TextColor3 = Color3.fromRGB(255,80,80)
Close.Font = Enum.Font.GothamBold
Close.TextSize = 18
Close.ZIndex = 12

Close.MouseButton1Click:Connect(function()
	Main.Visible = false
end)

-- OPEN / LOGO BUTTON
local Open = Instance.new("TextButton", ScreenGui)
Open.Size = UDim2.new(0,60,0,30)
Open.Position = UDim2.new(0,10,0.5,0)
Open.Text = "OPEN"
Open.Font = Enum.Font.GothamBold
Open.TextSize = 14
Open.BackgroundColor3 = Color3.fromRGB(30,30,30)
Open.TextColor3 = Color3.new(1,1,1)
Open.BorderSizePixel = 0
Open.ZIndex = 20
Open.Active = true
Open.Draggable = true
Instance.new("UICorner", Open).CornerRadius = UDim.new(0,8)

Open.MouseButton1Click:Connect(function()
	Main.Visible = not Main.Visible
end)

-- ESP TOGGLE
local ESP = false

local EspBtn = Instance.new("TextButton", Main)
EspBtn.Size = UDim2.new(0.9,0,0,40)
EspBtn.Position = UDim2.new(0.05,0,0,80)
EspBtn.Text = "üëÅ ESP Player [OFF]"
EspBtn.Font = Enum.Font.Gotham
EspBtn.TextSize = 15
EspBtn.BackgroundColor3 = Color3.fromRGB(45,45,45)
EspBtn.TextColor3 = Color3.new(1,1,1)
EspBtn.BorderSizePixel = 0
EspBtn.ZIndex = 11
Instance.new("UICorner", EspBtn).CornerRadius = UDim.new(0,8)

EspBtn.MouseButton1Click:Connect(function()
	ESP = not ESP
	EspBtn.Text = ESP and "üëÅ ESP Player [ON]" or "üëÅ ESP Player [OFF]"
end)

-- ESP LOGIC
-- =========================
-- HIGHLIGHT PLAYER (SURVIVOR / KILLER)
-- =========================
local function getRole(plr)
	if plr.Team and string.find(string.lower(plr.Team.Name), "killer") then
		return "KILLER"
	end
	return "SURVIVOR"
end

RunService.RenderStepped:Connect(function()
	for _, plr in pairs(Players:GetPlayers()) do
		if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
			if ESP then
				if not plr.Character:FindFirstChild("RennHL") then
					local hl = Instance.new("Highlight", plr.Character)
					hl.Name = "RennHL"
					hl.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
					hl.FillTransparency = 0.5
					hl.OutlineTransparency = 0
				end

				local role = getRole(plr)
				local hl = plr.Character:FindFirstChild("RennHL")
				if hl then
					if role == "KILLER" then
						hl.FillColor = Color3.fromRGB(255, 60, 60)
						hl.OutlineColor = Color3.fromRGB(255, 0, 0)
					else
						hl.FillColor = Color3.fromRGB(60, 255, 60)
						hl.OutlineColor = Color3.fromRGB(0, 255, 0)
					end
				end
			else
				if plr.Character:FindFirstChild("RennHL") then
					plr.Character.RennHL:Destroy()
				end
			end
		end
	end
end)
RunService.RenderStepped:Connect(function()
	for _,plr in pairs(Players:GetPlayers()) do
		if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("Head") then
			if ESP then
				if not plr.Character.Head:FindFirstChild("RennESP") then
					local bill = Instance.new("BillboardGui", plr.Character.Head)
					bill.Name = "RennESP"
					bill.Size = UDim2.new(0,150,0,40)
					bill.AlwaysOnTop = true

					local txt = Instance.new("TextLabel", bill)
					txt.Size = UDim2.new(1,0,1,0)
					txt.BackgroundTransparency = 1
					txt.Font = Enum.Font.GothamBold
					txt.TextSize = 14
					txt.TextColor3 = Color3.new(1,0,0)

					RunService.RenderStepped:Connect(function()
						if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart")
						and LocalPlayer.Character
						and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
							local dist = (LocalPlayer.Character.HumanoidRootPart.Position -
								plr.Character.HumanoidRootPart.Position).Magnitude
							txt.Text = plr.Name.." | "..math.floor(dist).."m"
						end
					end)
				end
			else
				local e = plr.Character.Head:FindFirstChild("RennESP")
				if e then e:Destroy() end
			end
		end
	end
end)
